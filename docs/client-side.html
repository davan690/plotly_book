<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>22 Leveraging web technologies from R | Interactive web-based data visualization with R, plotly, and shiny</title>
  <meta name="description" content="A useR guide to creating highly interactive graphics for exploratory and expository visualization." />
  <meta name="generator" content="bookdown 0.16.5 and GitBook 2.6.7" />

  <meta property="og:title" content="22 Leveraging web technologies from R | Interactive web-based data visualization with R, plotly, and shiny" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A useR guide to creating highly interactive graphics for exploratory and expository visualization." />
  <meta name="github-repo" content="ropensci/plotly" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="22 Leveraging web technologies from R | Interactive web-based data visualization with R, plotly, and shiny" />
  <meta name="twitter:site" content="@cpsievert" />
  <meta name="twitter:description" content="A useR guide to creating highly interactive graphics for exploratory and expository visualization." />
  

<meta name="author" content="Carson Sievert" />


<meta name="date" content="2019-12-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="supplying-custom-data.html"/>
<link rel="next" href="is-plotly-free-secure.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<script src="libs/elevate-section-attrs/elevate-section-attrs.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>
<link href="libs/selectize/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize/selectize.min.js"></script>
<link href="libs/colourpicker/colourpicker.min.css" rel="stylesheet" />
<script src="libs/colourpicker/colourpicker.min.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/plotly.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/summary-fix.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="preface.html"><a href="preface.html#why-interactive-web-graphics-from-r"><i class="fa fa-check"></i><b>1.1</b> Why interactive web graphics <em>from R</em>?</a></li>
<li class="chapter" data-level="1.2" data-path="preface.html"><a href="preface.html#what-you-will-learn"><i class="fa fa-check"></i><b>1.2</b> What you will learn</a></li>
<li class="chapter" data-level="1.3" data-path="preface.html"><a href="preface.html#what-you-wont-learn-much-of"><i class="fa fa-check"></i><b>1.3</b> What you won’t learn (much of)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="preface.html"><a href="preface.html#web-technologies"><i class="fa fa-check"></i><b>1.3.1</b> Web technologies</a></li>
<li class="chapter" data-level="1.3.2" data-path="preface.html"><a href="preface.html#d3js"><i class="fa fa-check"></i><b>1.3.2</b> d3js</a></li>
<li class="chapter" data-level="1.3.3" data-path="preface.html"><a href="preface.html#ggplot2"><i class="fa fa-check"></i><b>1.3.3</b> ggplot2</a></li>
<li class="chapter" data-level="1.3.4" data-path="preface.html"><a href="preface.html#graphical-data-analysis"><i class="fa fa-check"></i><b>1.3.4</b> Graphical data analysis</a></li>
<li class="chapter" data-level="1.3.5" data-path="preface.html"><a href="preface.html#data-visualization-best-practices"><i class="fa fa-check"></i><b>1.3.5</b> Data visualization best practices</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="preface.html"><a href="preface.html#prerequisites"><i class="fa fa-check"></i><b>1.4</b> Prerequisites</a></li>
<li class="chapter" data-level="1.5" data-path="preface.html"><a href="preface.html#run-code-examples"><i class="fa fa-check"></i><b>1.5</b> Run code examples</a></li>
<li class="chapter" data-level="1.6" data-path="preface.html"><a href="preface.html#getting-help-and-learning-more"><i class="fa fa-check"></i><b>1.6</b> Getting help and learning more</a></li>
<li class="chapter" data-level="1.7" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.8" data-path="preface.html"><a href="preface.html#colophon"><i class="fa fa-check"></i><b>1.8</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Creating views</b></span></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#intro-plotly"><i class="fa fa-check"></i><b>2.1</b> Intro to <code>plot_ly()</code></a></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#intro-plotly-js"><i class="fa fa-check"></i><b>2.2</b> Intro to plotly.js</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#intro-ggplotly"><i class="fa fa-check"></i><b>2.3</b> Intro to <code>ggplotly()</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scatter-traces.html"><a href="scatter-traces.html"><i class="fa fa-check"></i><b>3</b> Scattered foundations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scatter-traces.html"><a href="scatter-traces.html#markers"><i class="fa fa-check"></i><b>3.1</b> Markers</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-alpha"><i class="fa fa-check"></i><b>3.1.1</b> Alpha blending</a></li>
<li class="chapter" data-level="3.1.2" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-color"><i class="fa fa-check"></i><b>3.1.2</b> Colors</a></li>
<li class="chapter" data-level="3.1.3" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-symbol"><i class="fa fa-check"></i><b>3.1.3</b> Symbols</a></li>
<li class="chapter" data-level="3.1.4" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-stroke"><i class="fa fa-check"></i><b>3.1.4</b> Stroke and span</a></li>
<li class="chapter" data-level="3.1.5" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-size"><i class="fa fa-check"></i><b>3.1.5</b> Size</a></li>
<li class="chapter" data-level="3.1.6" data-path="scatter-traces.html"><a href="scatter-traces.html#dot-plots"><i class="fa fa-check"></i><b>3.1.6</b> Dotplots &amp; error bars</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="scatter-traces.html"><a href="scatter-traces.html#lines"><i class="fa fa-check"></i><b>3.2</b> Lines</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="scatter-traces.html"><a href="scatter-traces.html#linetypes"><i class="fa fa-check"></i><b>3.2.1</b> Linetypes</a></li>
<li class="chapter" data-level="3.2.2" data-path="scatter-traces.html"><a href="scatter-traces.html#segments"><i class="fa fa-check"></i><b>3.2.2</b> Segments</a></li>
<li class="chapter" data-level="3.2.3" data-path="scatter-traces.html"><a href="scatter-traces.html#density-plots"><i class="fa fa-check"></i><b>3.2.3</b> Density plots</a></li>
<li class="chapter" data-level="3.2.4" data-path="scatter-traces.html"><a href="scatter-traces.html#parallel-coordinates"><i class="fa fa-check"></i><b>3.2.4</b> Parallel Coordinates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scatter-traces.html"><a href="scatter-traces.html#polygons"><i class="fa fa-check"></i><b>3.3</b> Polygons</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="scatter-traces.html"><a href="scatter-traces.html#ribbons"><i class="fa fa-check"></i><b>3.3.1</b> Ribbons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>4</b> Maps</a>
<ul>
<li class="chapter" data-level="4.1" data-path="maps.html"><a href="maps.html#maps-integrated"><i class="fa fa-check"></i><b>4.1</b> Integrated maps</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="maps.html"><a href="maps.html#overview-1"><i class="fa fa-check"></i><b>4.1.1</b> Overview</a></li>
<li class="chapter" data-level="4.1.2" data-path="maps.html"><a href="maps.html#choropleths"><i class="fa fa-check"></i><b>4.1.2</b> Choropleths</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="maps.html"><a href="maps.html#maps-custom"><i class="fa fa-check"></i><b>4.2</b> Custom maps</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="maps.html"><a href="maps.html#sf"><i class="fa fa-check"></i><b>4.2.1</b> Simple features (sf)</a></li>
<li class="chapter" data-level="4.2.2" data-path="maps.html"><a href="maps.html#cartograms"><i class="fa fa-check"></i><b>4.2.2</b> Cartograms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bars-histograms.html"><a href="bars-histograms.html"><i class="fa fa-check"></i><b>5</b> Bars &amp; histograms</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bars-histograms.html"><a href="bars-histograms.html#multiple-numeric-distributions"><i class="fa fa-check"></i><b>5.1</b> Multiple numeric distributions</a></li>
<li class="chapter" data-level="5.2" data-path="bars-histograms.html"><a href="bars-histograms.html#multiple-discrete-distributions"><i class="fa fa-check"></i><b>5.2</b> Multiple discrete distributions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>6</b> Boxplots</a></li>
<li class="chapter" data-level="7" data-path="frequencies-2D.html"><a href="frequencies-2D.html"><i class="fa fa-check"></i><b>7</b> 2D frequencies</a>
<ul>
<li class="chapter" data-level="7.1" data-path="frequencies-2D.html"><a href="frequencies-2D.html#rectangular-binning-in-plotly.js"><i class="fa fa-check"></i><b>7.1</b> Rectangular binning in plotly.js</a></li>
<li class="chapter" data-level="7.2" data-path="frequencies-2D.html"><a href="frequencies-2D.html#rectangular-binning-in-r"><i class="fa fa-check"></i><b>7.2</b> Rectangular binning in R</a></li>
<li class="chapter" data-level="7.3" data-path="frequencies-2D.html"><a href="frequencies-2D.html#categorical-axes"><i class="fa fa-check"></i><b>7.3</b> Categorical axes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="d-charts.html"><a href="d-charts.html"><i class="fa fa-check"></i><b>8</b> 3D charts</a>
<ul>
<li class="chapter" data-level="8.1" data-path="d-charts.html"><a href="d-charts.html#markers-1"><i class="fa fa-check"></i><b>8.1</b> Markers</a></li>
<li class="chapter" data-level="8.2" data-path="d-charts.html"><a href="d-charts.html#paths"><i class="fa fa-check"></i><b>8.2</b> Paths</a></li>
<li class="chapter" data-level="8.3" data-path="d-charts.html"><a href="d-charts.html#lines-1"><i class="fa fa-check"></i><b>8.3</b> Lines</a></li>
<li class="chapter" data-level="8.4" data-path="d-charts.html"><a href="d-charts.html#axes"><i class="fa fa-check"></i><b>8.4</b> Axes</a></li>
<li class="chapter" data-level="8.5" data-path="d-charts.html"><a href="d-charts.html#surfaces"><i class="fa fa-check"></i><b>8.5</b> Surfaces</a></li>
</ul></li>
<li class="part"><span><b>II Publishing views</b></span></li>
<li class="chapter" data-level="9" data-path="publish.html"><a href="publish.html"><i class="fa fa-check"></i><b>9</b> Introduction</a></li>
<li class="chapter" data-level="10" data-path="saving.html"><a href="saving.html"><i class="fa fa-check"></i><b>10</b> Saving and embedding HTML</a></li>
<li class="chapter" data-level="11" data-path="exporting-static-images.html"><a href="exporting-static-images.html"><i class="fa fa-check"></i><b>11</b> Exporting static images</a>
<ul>
<li class="chapter" data-level="11.1" data-path="exporting-static-images.html"><a href="exporting-static-images.html#with-code"><i class="fa fa-check"></i><b>11.1</b> With code</a></li>
<li class="chapter" data-level="11.2" data-path="exporting-static-images.html"><a href="exporting-static-images.html#from-a-browser"><i class="fa fa-check"></i><b>11.2</b> From a browser</a></li>
<li class="chapter" data-level="11.3" data-path="exporting-static-images.html"><a href="exporting-static-images.html#sizing-exports"><i class="fa fa-check"></i><b>11.3</b> Sizing exports</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="editing-views.html"><a href="editing-views.html"><i class="fa fa-check"></i><b>12</b> Editing views for publishing</a></li>
<li class="part"><span><b>III Combining multiple views</b></span></li>
<li class="chapter" data-level="13" data-path="arranging-views.html"><a href="arranging-views.html"><i class="fa fa-check"></i><b>13</b> Arranging views</a>
<ul>
<li class="chapter" data-level="13.1" data-path="arranging-views.html"><a href="arranging-views.html#arranging-plotly-objects"><i class="fa fa-check"></i><b>13.1</b> Arranging plotly objects</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="arranging-views.html"><a href="arranging-views.html#recursive-subplots"><i class="fa fa-check"></i><b>13.1.1</b> Recursive subplots</a></li>
<li class="chapter" data-level="13.1.2" data-path="arranging-views.html"><a href="arranging-views.html#other-approaches-applications"><i class="fa fa-check"></i><b>13.1.2</b> Other approaches &amp; applications</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="arranging-views.html"><a href="arranging-views.html#arranging-htmlwidgets"><i class="fa fa-check"></i><b>13.2</b> Arranging htmlwidgets</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="arranging-views.html"><a href="arranging-views.html#flexdashboard"><i class="fa fa-check"></i><b>13.2.1</b> Flexdashboard</a></li>
<li class="chapter" data-level="13.2.2" data-path="arranging-views.html"><a href="arranging-views.html#bootstrap-grid-layout"><i class="fa fa-check"></i><b>13.2.2</b> Bootstrap grid layout</a></li>
<li class="chapter" data-level="13.2.3" data-path="arranging-views.html"><a href="arranging-views.html#css-flexbox"><i class="fa fa-check"></i><b>13.2.3</b> CSS flexbox</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="arranging-views.html"><a href="arranging-views.html#navigating-many-views"><i class="fa fa-check"></i><b>13.3</b> Arranging many views</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="animating-views.html"><a href="animating-views.html"><i class="fa fa-check"></i><b>14</b> Animating views</a>
<ul>
<li class="chapter" data-level="14.1" data-path="animating-views.html"><a href="animating-views.html#animation-api"><i class="fa fa-check"></i><b>14.1</b> Animation API</a></li>
<li class="chapter" data-level="14.2" data-path="animating-views.html"><a href="animating-views.html#animation-support"><i class="fa fa-check"></i><b>14.2</b> Animation support</a></li>
</ul></li>
<li class="part"><span><b>IV Linking multiple views</b></span></li>
<li class="chapter" data-level="15" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>15</b> Introduction</a></li>
<li class="chapter" data-level="16" data-path="client-side-linking.html"><a href="client-side-linking.html"><i class="fa fa-check"></i><b>16</b> Client-side linking</a>
<ul>
<li class="chapter" data-level="16.1" data-path="client-side-linking.html"><a href="client-side-linking.html#graphical-queries"><i class="fa fa-check"></i><b>16.1</b> Graphical queries</a></li>
<li class="chapter" data-level="16.2" data-path="client-side-linking.html"><a href="client-side-linking.html#filter"><i class="fa fa-check"></i><b>16.2</b> Highlight versus filter events</a></li>
<li class="chapter" data-level="16.3" data-path="client-side-linking.html"><a href="client-side-linking.html#linking-animated-views"><i class="fa fa-check"></i><b>16.3</b> Linking animated views</a></li>
<li class="chapter" data-level="16.4" data-path="client-side-linking.html"><a href="client-side-linking.html#querying-examples"><i class="fa fa-check"></i><b>16.4</b> Examples</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="client-side-linking.html"><a href="client-side-linking.html#trellis-linking"><i class="fa fa-check"></i><b>16.4.1</b> Querying facetted charts</a></li>
<li class="chapter" data-level="16.4.2" data-path="client-side-linking.html"><a href="client-side-linking.html#statistical-queries"><i class="fa fa-check"></i><b>16.4.2</b> Statistical queries</a></li>
<li class="chapter" data-level="16.4.3" data-path="client-side-linking.html"><a href="client-side-linking.html#statistical-queries-ggplot"><i class="fa fa-check"></i><b>16.4.3</b> Statistical queries with <code>ggplotly()</code></a></li>
<li class="chapter" data-level="16.4.4" data-path="client-side-linking.html"><a href="client-side-linking.html#geo-spatial-queries"><i class="fa fa-check"></i><b>16.4.4</b> Geo-spatial queries</a></li>
<li class="chapter" data-level="16.4.5" data-path="client-side-linking.html"><a href="client-side-linking.html#linking-with-other-htmlwidgets"><i class="fa fa-check"></i><b>16.4.5</b> Linking with other htmlwidgets</a></li>
<li class="chapter" data-level="16.4.6" data-path="client-side-linking.html"><a href="client-side-linking.html#ggally-ggpairs"><i class="fa fa-check"></i><b>16.4.6</b> Generalized pairs plots</a></li>
<li class="chapter" data-level="16.4.7" data-path="client-side-linking.html"><a href="client-side-linking.html#ggally-ggnostic"><i class="fa fa-check"></i><b>16.4.7</b> Querying diagnostic plots</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="client-side-linking.html"><a href="client-side-linking.html#limitations"><i class="fa fa-check"></i><b>16.5</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html"><i class="fa fa-check"></i><b>17</b> Server-side linking with shiny</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#hello-shiny"><i class="fa fa-check"></i><b>17.1</b> Embedding plotly in shiny</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#your-first-shiny-app"><i class="fa fa-check"></i><b>17.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="17.1.2" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#hiding-and-redrawing-on-resize"><i class="fa fa-check"></i><b>17.1.2</b> Hiding and redrawing on resize</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#shiny-plotly-inputs"><i class="fa fa-check"></i><b>17.2</b> Leveraging plotly input events</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#dragging-events"><i class="fa fa-check"></i><b>17.2.1</b> Dragging events</a></li>
<li class="chapter" data-level="17.2.2" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#d-events"><i class="fa fa-check"></i><b>17.2.2</b> 3D events</a></li>
<li class="chapter" data-level="17.2.3" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#edit-events"><i class="fa fa-check"></i><b>17.2.3</b> Edit events</a></li>
<li class="chapter" data-level="17.2.4" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#relayout-vs-restyle-events"><i class="fa fa-check"></i><b>17.2.4</b> Relayout vs restyle events</a></li>
<li class="chapter" data-level="17.2.5" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#scoping-events"><i class="fa fa-check"></i><b>17.2.5</b> Scoping events</a></li>
<li class="chapter" data-level="17.2.6" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#event-priority"><i class="fa fa-check"></i><b>17.2.6</b> Event priority</a></li>
<li class="chapter" data-level="17.2.7" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#handling-discrete-axes"><i class="fa fa-check"></i><b>17.2.7</b> Handling discrete axes</a></li>
<li class="chapter" data-level="17.2.8" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#reactive-vals"><i class="fa fa-check"></i><b>17.2.8</b> Accumulating and managing event data</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#shiny-performance"><i class="fa fa-check"></i><b>17.3</b> Improving performance</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#proxies"><i class="fa fa-check"></i><b>17.3.1</b> Partial plotly updates</a></li>
<li class="chapter" data-level="17.3.2" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#partial-update-examples"><i class="fa fa-check"></i><b>17.3.2</b> Partial update examples</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#advanced-applications"><i class="fa fa-check"></i><b>17.4</b> Advanced applications</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#drill-down"><i class="fa fa-check"></i><b>17.4.1</b> Drill-down</a></li>
<li class="chapter" data-level="17.4.2" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#crossfilter"><i class="fa fa-check"></i><b>17.4.2</b> Cross-filter</a></li>
<li class="chapter" data-level="17.4.3" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#drag-brush"><i class="fa fa-check"></i><b>17.4.3</b> A draggable brush</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#discussion"><i class="fa fa-check"></i><b>17.5</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>V Event handling in JavaScript</b></span></li>
<li class="chapter" data-level="18" data-path="javascript.html"><a href="javascript.html"><i class="fa fa-check"></i><b>18</b> Introduction</a></li>
<li class="chapter" data-level="19" data-path="json.html"><a href="json.html"><i class="fa fa-check"></i><b>19</b> Working with JSON</a>
<ul>
<li class="chapter" data-level="19.1" data-path="json.html"><a href="json.html#assignment-subsetting-and-iteration"><i class="fa fa-check"></i><b>19.1</b> Assignment, subsetting, and iteration</a></li>
<li class="chapter" data-level="19.2" data-path="json.html"><a href="json.html#mapping-r-to-json"><i class="fa fa-check"></i><b>19.2</b> Mapping R to JSON</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="js-event-handlers.html"><a href="js-event-handlers.html"><i class="fa fa-check"></i><b>20</b> Adding custom event handlers</a></li>
<li class="chapter" data-level="21" data-path="supplying-custom-data.html"><a href="supplying-custom-data.html"><i class="fa fa-check"></i><b>21</b> Supplying custom data</a></li>
<li class="chapter" data-level="22" data-path="client-side.html"><a href="client-side.html"><i class="fa fa-check"></i><b>22</b> Leveraging web technologies from R</a>
<ul>
<li class="chapter" data-level="22.1" data-path="client-side.html"><a href="client-side.html#web-infrastructure"><i class="fa fa-check"></i><b>22.1</b> Web infrastructure</a></li>
<li class="chapter" data-level="22.2" data-path="client-side.html"><a href="client-side.html#react"><i class="fa fa-check"></i><b>22.2</b> Modern JS &amp; React</a></li>
</ul></li>
<li class="part"><span><b>VI Various special topics</b></span></li>
<li class="chapter" data-level="23" data-path="is-plotly-free-secure.html"><a href="is-plotly-free-secure.html"><i class="fa fa-check"></i><b>23</b> Is plotly free &amp; secure?</a></li>
<li class="chapter" data-level="24" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>24</b> Improving performance</a></li>
<li class="chapter" data-level="25" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html"><i class="fa fa-check"></i><b>25</b> Controlling tooltips</a>
<ul>
<li class="chapter" data-level="25.1" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html#tooltip-text"><i class="fa fa-check"></i><b>25.1</b> <code>plot_ly()</code> tooltips</a></li>
<li class="chapter" data-level="25.2" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html#tooltip-text-ggplotly"><i class="fa fa-check"></i><b>25.2</b> <code>ggplotly()</code> tooltips</a></li>
<li class="chapter" data-level="25.3" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html#styling"><i class="fa fa-check"></i><b>25.3</b> Styling</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="control-modebar.html"><a href="control-modebar.html"><i class="fa fa-check"></i><b>26</b> Control the modebar</a>
<ul>
<li class="chapter" data-level="26.1" data-path="control-modebar.html"><a href="control-modebar.html#remove-the-entire-modebar"><i class="fa fa-check"></i><b>26.1</b> Remove the entire modebar</a></li>
<li class="chapter" data-level="26.2" data-path="control-modebar.html"><a href="control-modebar.html#remove-the-plotly-logo"><i class="fa fa-check"></i><b>26.2</b> Remove the plotly logo</a></li>
<li class="chapter" data-level="26.3" data-path="control-modebar.html"><a href="control-modebar.html#remove-modebar-buttons-by-name"><i class="fa fa-check"></i><b>26.3</b> Remove modebar buttons by name</a></li>
<li class="chapter" data-level="26.4" data-path="control-modebar.html"><a href="control-modebar.html#add-custom-modebar-buttons"><i class="fa fa-check"></i><b>26.4</b> Add custom modebar buttons</a></li>
<li class="chapter" data-level="26.5" data-path="control-modebar.html"><a href="control-modebar.html#control-image-downloads"><i class="fa fa-check"></i><b>26.5</b> Control image downloads</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="working-with-colors.html"><a href="working-with-colors.html"><i class="fa fa-check"></i><b>27</b> Working with colors</a></li>
<li class="chapter" data-level="28" data-path="working-with-symbols.html"><a href="working-with-symbols.html"><i class="fa fa-check"></i><b>28</b> Working with symbols and glyphs</a></li>
<li class="chapter" data-level="29" data-path="embedding-images.html"><a href="embedding-images.html"><i class="fa fa-check"></i><b>29</b> Embedding images</a></li>
<li class="chapter" data-level="30" data-path="locales.html"><a href="locales.html"><i class="fa fa-check"></i><b>30</b> Language support</a></li>
<li class="chapter" data-level="31" data-path="mathjax.html"><a href="mathjax.html"><i class="fa fa-check"></i><b>31</b> LaTeX rendering</a>
<ul>
<li class="chapter" data-level="31.1" data-path="mathjax.html"><a href="mathjax.html#mathjax-caveats"><i class="fa fa-check"></i><b>31.1</b> MathJax caveats</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="the-data-plot-pipeline.html"><a href="the-data-plot-pipeline.html"><i class="fa fa-check"></i><b>32</b> The data-plot-pipeline</a></li>
<li class="chapter" data-level="33" data-path="improving-ggplotly.html"><a href="improving-ggplotly.html"><i class="fa fa-check"></i><b>33</b> Improving <code>ggplotly()</code></a>
<ul>
<li class="chapter" data-level="33.1" data-path="improving-ggplotly.html"><a href="improving-ggplotly.html#modifying-layout"><i class="fa fa-check"></i><b>33.1</b> Modifying layout</a></li>
<li class="chapter" data-level="33.2" data-path="improving-ggplotly.html"><a href="improving-ggplotly.html#modifying-data"><i class="fa fa-check"></i><b>33.2</b> Modifying data</a></li>
<li class="chapter" data-level="33.3" data-path="improving-ggplotly.html"><a href="improving-ggplotly.html#leveraging-statistical-output"><i class="fa fa-check"></i><b>33.3</b> Leveraging statistical output</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="custom-geoms.html"><a href="custom-geoms.html"><i class="fa fa-check"></i><b>34</b> Translating custom ggplot2 geoms</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive web-based data visualization with R, plotly, and shiny</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="client-side" class="section level1">
<h1><span class="header-section-number">22</span> Leveraging web technologies from R</h1>
<div id="web-infrastructure" class="section level2">
<h2><span class="header-section-number">22.1</span> Web infrastructure</h2>
<p>
</p>
<p>Sometimes supplying <code>customdata</code> isn’t the best way to achieve a particular interactive feature. In those cases, you likely want to leverage other R lower-level interfaces to web technologies. Recall from Section <a href="arranging-views.html#arranging-htmlwidgets">13.2</a> that <strong>htmlwidgets</strong> objects are a special case of <strong>htmltools</strong> tags. That means, you can always complement your widget(s) with arbitrary HTML content by adding additional tags. Figure <a href="client-side.html#fig:correlation-client-side">22.1</a> leverages this idea to place an empty HTML <code>&lt;div&gt;</code> container below the correlation heatmap which is then populated with a <strong>plotly</strong> scatterplot upon clicking a cell. As it turns out, you <em>could</em> implement Figure <a href="client-side.html#fig:correlation-client-side">22.1</a> by binding x/y data to each heatmap cell via <code>customdata</code>, but that would require the browser to store twice the amount of data as what’s required here. Instead, this approach serializes the input data (<code>mtcars</code>) into a JSON file via <strong>jsonlite</strong> so the webpage can read and parse the full dataset once and select just the two required columns when required (on click). There are a lot of ways to read JSON in JavaScript, but here we use the d3.js library’s <code>d3.json()</code> since <strong>plotly</strong> already comes bundled with the library <span class="citation">(Heer <a href="#ref-d3js" role="doc-biblioref">2011</a>)</span>. Also, since the HTML file is reading the JSON from disk, most browsers won’t render the HTML file directly (at least, by default, for security reasons). To get around that, we can start up a simple web server from R using <strong>servr</strong> to serve both the HTML and JSON in way that your browser will deem safe to run <span class="citation">(Xie <a href="#ref-servr" role="doc-biblioref">2016</a>)</span>.</p>
<details>
<p><summary>Click to see code</summary></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="client-side.html#cb206-1"></a><span class="kw">library</span>(plotly)</span>
<span id="cb206-2"><a href="client-side.html#cb206-2"></a><span class="kw">library</span>(htmltools)</span>
<span id="cb206-3"><a href="client-side.html#cb206-3"></a></span>
<span id="cb206-4"><a href="client-side.html#cb206-4"></a>nms &lt;-<span class="st"> </span><span class="kw">names</span>(mtcars)</span>
<span id="cb206-5"><a href="client-side.html#cb206-5"></a></span>
<span id="cb206-6"><a href="client-side.html#cb206-6"></a>p &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(<span class="dt">colors =</span> <span class="st">&quot;RdBu&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb206-7"><a href="client-side.html#cb206-7"></a><span class="st">  </span><span class="kw">add_heatmap</span>(</span>
<span id="cb206-8"><a href="client-side.html#cb206-8"></a>    <span class="dt">x =</span> nms, </span>
<span id="cb206-9"><a href="client-side.html#cb206-9"></a>    <span class="dt">y =</span> nms, </span>
<span id="cb206-10"><a href="client-side.html#cb206-10"></a>    <span class="dt">z =</span> <span class="op">~</span><span class="kw">round</span>(<span class="kw">cor</span>(mtcars), <span class="dv">3</span>)</span>
<span id="cb206-11"><a href="client-side.html#cb206-11"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb206-12"><a href="client-side.html#cb206-12"></a><span class="st">  </span><span class="kw">onRender</span>(<span class="st">&quot;</span></span>
<span id="cb206-13"><a href="client-side.html#cb206-13"></a><span class="st">    function(el) {</span></span>
<span id="cb206-14"><a href="client-side.html#cb206-14"></a><span class="st">      Plotly.d3.json(&#39;mtcars.json&#39;, function(mtcars) {</span></span>
<span id="cb206-15"><a href="client-side.html#cb206-15"></a><span class="st">        el.on(&#39;plotly_click&#39;, function(d) {</span></span>
<span id="cb206-16"><a href="client-side.html#cb206-16"></a><span class="st">          var x = d.points[0].x;</span></span>
<span id="cb206-17"><a href="client-side.html#cb206-17"></a><span class="st">          var y = d.points[0].y;</span></span>
<span id="cb206-18"><a href="client-side.html#cb206-18"></a><span class="st">          var trace = {</span></span>
<span id="cb206-19"><a href="client-side.html#cb206-19"></a><span class="st">            x: mtcars[x],</span></span>
<span id="cb206-20"><a href="client-side.html#cb206-20"></a><span class="st">            y: mtcars[y],</span></span>
<span id="cb206-21"><a href="client-side.html#cb206-21"></a><span class="st">            mode: &#39;markers&#39;</span></span>
<span id="cb206-22"><a href="client-side.html#cb206-22"></a><span class="st">          };</span></span>
<span id="cb206-23"><a href="client-side.html#cb206-23"></a><span class="st">          Plotly.newPlot(&#39;filtered-plot&#39;, [trace]);</span></span>
<span id="cb206-24"><a href="client-side.html#cb206-24"></a><span class="st">        });</span></span>
<span id="cb206-25"><a href="client-side.html#cb206-25"></a><span class="st">      });</span></span>
<span id="cb206-26"><a href="client-side.html#cb206-26"></a><span class="st">    }</span></span>
<span id="cb206-27"><a href="client-side.html#cb206-27"></a><span class="st">&quot;</span>)</span>
<span id="cb206-28"><a href="client-side.html#cb206-28"></a></span>
<span id="cb206-29"><a href="client-side.html#cb206-29"></a></span>
<span id="cb206-30"><a href="client-side.html#cb206-30"></a><span class="co"># In a temporary directory, save the mtcars dataset as json and</span></span>
<span id="cb206-31"><a href="client-side.html#cb206-31"></a><span class="co"># the html to an index.html file, then open via a web server</span></span>
<span id="cb206-32"><a href="client-side.html#cb206-32"></a>withr<span class="op">::</span><span class="kw">with_path</span>(<span class="kw">tempdir</span>(), {</span>
<span id="cb206-33"><a href="client-side.html#cb206-33"></a>  jsonlite<span class="op">::</span><span class="kw">write_json</span>(<span class="kw">as.list</span>(mtcars), <span class="st">&quot;mtcars.json&quot;</span>)</span>
<span id="cb206-34"><a href="client-side.html#cb206-34"></a>  html &lt;-<span class="st"> </span><span class="kw">tagList</span>(p, tags<span class="op">$</span><span class="kw">div</span>(<span class="dt">id =</span> <span class="st">&#39;filtered-plot&#39;</span>))</span>
<span id="cb206-35"><a href="client-side.html#cb206-35"></a>  <span class="kw">save_html</span>(html, <span class="st">&quot;index.html&quot;</span>)</span>
<span id="cb206-36"><a href="client-side.html#cb206-36"></a>  <span class="cf">if</span> (<span class="kw">interactive</span>()) servr<span class="op">::</span><span class="kw">httd</span>()</span>
<span id="cb206-37"><a href="client-side.html#cb206-37"></a>})</span></code></pre></div>
</details>
<div class="figure" style="text-align: center"><span id="fig:correlation-client-side"></span>
<iframe src="https://player.vimeo.com/video/307598118?title=0&amp;byline=0&amp;portrait=0" width="100%" height="700" frameborder="0" seamless="seamless" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<p class="caption">
FIGURE 22.1: Clicking on a correlation matrix to populate a scatterplot. For the interactive, see <a href="https://plotly-r.com/interactives/correlation-client-side.html" class="uri">https://plotly-r.com/interactives/correlation-client-side.html</a>
</p>
</div>
</div>
<div id="react" class="section level2">
<h2><span class="header-section-number">22.2</span> Modern JS &amp; React</h2>
<p></p>
<p>All the JavaScript (JS) we’ve seen thus far is natively supported by modern web browsers, but for larger projects, you may want to leverage modern versions of JS (i.e., ES6, ES7, etc) and modern JS development tools (e.g., Babel, Webpack, etc) for compiling modern JS to a version that all browsers can support (i.e., ES2015). The current landscape of JS development tooling is large, complex, fragmented, difficult for non-experts to navigate, and mostly beyond the scope of this book. However, thanks to R packages like <strong>V8</strong>, <strong>reactR</strong>, and <strong>runpkg</strong>, it turns out we can effectively leverage React<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a> components<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a> from R without fussing with system commands or setting up a complicated JS build toolchain.</p>
<p>The R package <strong>runpkg</strong> makes it easy to download any <a href="https://www.npmjs.com/">npm</a> (the main repository network for JS) package (via <a href="https://unpkg.com/" class="uri">https://unpkg.com/</a>) and include it in a web page generated through the <strong>htmltools</strong> package <span class="citation">(Sievert <a href="#ref-runpkg" role="doc-biblioref">2019</a><a href="#ref-runpkg" role="doc-biblioref">b</a>)</span>. It does so by returning a <code>htmltools::htmlDependency()</code> object which encapsulates the downloaded files and includes the JS scripts (or CSS stylesheets) into any page that depends on that object. Here we use it to download a standalone bundle of a React library for rendering all sort of different video formats, called <code>react-player</code>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="client-side.html#cb207-1"></a>react_player &lt;-<span class="st"> </span>runpkg<span class="op">::</span><span class="kw">download_files</span>(</span>
<span id="cb207-2"><a href="client-side.html#cb207-2"></a>  <span class="st">&quot;react-player&quot;</span>, </span>
<span id="cb207-3"><a href="client-side.html#cb207-3"></a>  <span class="st">&quot;dist/ReactPlayer.standalone.js&quot;</span></span>
<span id="cb207-4"><a href="client-side.html#cb207-4"></a>)</span></code></pre></div>
<p>This <code>react-player</code> library provides a function called <code>renderReactPlayer()</code> that requires a placeholder (i.e., a DOM element) for inserting the video as well as a url (or file path) to the video. Figure <a href="client-side.html#fig:react-player">22.2</a> demonstrates how we could use it to render a YouTube video in response to a <strong>plotly</strong> click event:</p>
<details>
<p><summary>Click to see code</summary></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="client-side.html#cb208-1"></a><span class="kw">library</span>(htmltools)</span>
<span id="cb208-2"><a href="client-side.html#cb208-2"></a></span>
<span id="cb208-3"><a href="client-side.html#cb208-3"></a><span class="co"># the video placeholder</span></span>
<span id="cb208-4"><a href="client-side.html#cb208-4"></a>video &lt;-<span class="st"> </span>tags<span class="op">$</span><span class="kw">div</span>(<span class="dt">id =</span> <span class="st">&quot;video&quot;</span>)</span>
<span id="cb208-5"><a href="client-side.html#cb208-5"></a></span>
<span id="cb208-6"><a href="client-side.html#cb208-6"></a><span class="co"># upon clicking the marker, populate a video </span></span>
<span id="cb208-7"><a href="client-side.html#cb208-7"></a><span class="co"># in the DOM element with an id of &#39;video&#39;</span></span>
<span id="cb208-8"><a href="client-side.html#cb208-8"></a>p &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="kw">I</span>(<span class="dv">50</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb208-9"><a href="client-side.html#cb208-9"></a><span class="st">  </span><span class="kw">add_text</span>(</span>
<span id="cb208-10"><a href="client-side.html#cb208-10"></a>    <span class="dt">text =</span> emo<span class="op">::</span><span class="kw">ji</span>(<span class="st">&quot;rofl&quot;</span>),</span>
<span id="cb208-11"><a href="client-side.html#cb208-11"></a>    <span class="dt">customdata =</span> <span class="st">&quot;https://www.youtube.com/watch?v=oHg5SJYRHA0&quot;</span>,</span>
<span id="cb208-12"><a href="client-side.html#cb208-12"></a>    <span class="dt">hovertext =</span> <span class="st">&quot;Click me!&quot;</span>,</span>
<span id="cb208-13"><a href="client-side.html#cb208-13"></a>    <span class="dt">hoverinfo =</span> <span class="st">&quot;text&quot;</span></span>
<span id="cb208-14"><a href="client-side.html#cb208-14"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb208-15"><a href="client-side.html#cb208-15"></a><span class="st">  </span><span class="kw">onRender</span>(</span>
<span id="cb208-16"><a href="client-side.html#cb208-16"></a>    <span class="st">&quot;function(el) { </span></span>
<span id="cb208-17"><a href="client-side.html#cb208-17"></a><span class="st">       var container = document.getElementById(&#39;video&#39;);</span></span>
<span id="cb208-18"><a href="client-side.html#cb208-18"></a><span class="st">       el.on(&#39;plotly_click&#39;, function(d) {</span></span>
<span id="cb208-19"><a href="client-side.html#cb208-19"></a><span class="st">         var url = d.points[0].customdata;</span></span>
<span id="cb208-20"><a href="client-side.html#cb208-20"></a><span class="st">         renderReactPlayer(container, {url: url, playing: true});</span></span>
<span id="cb208-21"><a href="client-side.html#cb208-21"></a><span class="st">       })</span></span>
<span id="cb208-22"><a href="client-side.html#cb208-22"></a><span class="st">    }&quot;</span></span>
<span id="cb208-23"><a href="client-side.html#cb208-23"></a>  )</span>
<span id="cb208-24"><a href="client-side.html#cb208-24"></a></span>
<span id="cb208-25"><a href="client-side.html#cb208-25"></a><span class="co"># create the HTML page</span></span>
<span id="cb208-26"><a href="client-side.html#cb208-26"></a><span class="kw">browsable</span>(<span class="kw">tagList</span>(p, video, react_player))</span></code></pre></div>
</details>
<div class="figure" style="text-align: center"><span id="fig:react-player"></span>
<iframe src="https://player.vimeo.com/video/315308561?title=0&amp;byline=0&amp;portrait=0" width="100%" height="700" frameborder="0" seamless="seamless" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<p class="caption">
FIGURE 22.2: Using the <code>react-player</code> React component to render a video in response to a <code>'plotly_click'</code> event. For the interactive, see <a href="https://plotly-r.com/interactives/react-player.html" class="uri">https://plotly-r.com/interactives/react-player.html</a>
</p>
</div>
<p>This <code>react-player</code> React library is rather unique in that it provides a standalone function, <code>renderReactPlayer()</code>, that enables rendering of a React component without loading React itself or leveraging special React syntax like JSX. It’s more likely that the React component library will explicitly require you to import both React and ReactDOM. You could use <strong>runpkg</strong> to download these React/ReactDOM as well, but the <code>html_dependency_react()</code> function from <strong>reactR</strong> package makes this even easier <span class="citation">(Inc, Russell, and Dipert <a href="#ref-reactR" role="doc-biblioref">2019</a>)</span>. Furthermore, <strong>reactR</strong> provides a <code>babel_transform()</code> function which will compile modern JS (e.g., ES6, ES2017, etc) as well as special React markup (e.g., JSX) to a version of JS that all browsers support (e.g., ES5). For a toy example, Figure <a href="client-side.html#fig:babel">22.3</a> demonstrates how one could leverage ES6, React, and React’s JSX syntax to populate a <code>&lt;h1&gt;</code> title filled with a <code>customdata</code> message in response to a <strong>plotly</strong> click event.</p>
<details>
<p><summary>Click to see code</summary></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="client-side.html#cb209-1"></a><span class="kw">library</span>(reactR)</span>
<span id="cb209-2"><a href="client-side.html#cb209-2"></a></span>
<span id="cb209-3"><a href="client-side.html#cb209-3"></a><span class="co"># a placeholder for our react &#39;app&#39;</span></span>
<span id="cb209-4"><a href="client-side.html#cb209-4"></a>app &lt;-<span class="st"> </span>tags<span class="op">$</span><span class="kw">div</span>(<span class="dt">id =</span> <span class="st">&quot;app&quot;</span>)</span>
<span id="cb209-5"><a href="client-side.html#cb209-5"></a></span>
<span id="cb209-6"><a href="client-side.html#cb209-6"></a>p &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb209-7"><a href="client-side.html#cb209-7"></a><span class="st">  </span><span class="kw">add_markers</span>(<span class="dt">customdata =</span> <span class="st">&quot;Powered by React&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb209-8"><a href="client-side.html#cb209-8"></a><span class="st">  </span><span class="kw">onRender</span>(<span class="kw">babel_transform</span>(</span>
<span id="cb209-9"><a href="client-side.html#cb209-9"></a>    <span class="st">&quot;el =&gt; { </span></span>
<span id="cb209-10"><a href="client-side.html#cb209-10"></a><span class="st">      el.on(&#39;plotly_click&#39;, d =&gt; {</span></span>
<span id="cb209-11"><a href="client-side.html#cb209-11"></a><span class="st">        let msg = d.points[0].customdata;</span></span>
<span id="cb209-12"><a href="client-side.html#cb209-12"></a><span class="st">        ReactDOM.render(</span></span>
<span id="cb209-13"><a href="client-side.html#cb209-13"></a><span class="st">          &lt;h1&gt;{msg}&lt;/h1&gt;, </span></span>
<span id="cb209-14"><a href="client-side.html#cb209-14"></a><span class="st">          document.getElementById(&#39;app&#39;)</span></span>
<span id="cb209-15"><a href="client-side.html#cb209-15"></a><span class="st">        )</span></span>
<span id="cb209-16"><a href="client-side.html#cb209-16"></a><span class="st">      })</span></span>
<span id="cb209-17"><a href="client-side.html#cb209-17"></a><span class="st">    }&quot;</span></span>
<span id="cb209-18"><a href="client-side.html#cb209-18"></a>  ))</span>
<span id="cb209-19"><a href="client-side.html#cb209-19"></a></span>
<span id="cb209-20"><a href="client-side.html#cb209-20"></a><span class="co"># create the HTML page</span></span>
<span id="cb209-21"><a href="client-side.html#cb209-21"></a><span class="kw">browsable</span>(<span class="kw">tagList</span>(p, app, <span class="kw">html_dependency_react</span>()))</span></code></pre></div>
</details>
<div class="figure" style="text-align: center"><span id="fig:babel"></span>
<iframe src="https://player.vimeo.com/video/315309034?title=0&amp;byline=0&amp;portrait=0" width="100%" height="400" frameborder="0" seamless="seamless" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<p class="caption">
FIGURE 22.3: Using <code>babel_transform()</code> to leverage ES6, React, and JSX. For the interactive, see <a href="https://plotly-r.com/interactives/babel.html" class="uri">https://plotly-r.com/interactives/babel.html</a>
</p>
</div>
<p>For a more serious example, we could leverage another React component, named <code>react-data-grid</code>, to display the data within a <strong>plotly</strong> scatterplot brush, as done in Figure <a href="client-side.html#fig:react-data-grid">22.4</a>. Again, we can use <strong>runpkg</strong> to download a bundle of <code>react-data-grid</code>, but this library doesn’t come with <code>React</code>/<code>ReactDOM</code>, so we must explicitly include it this time around. In fact, this approach of explicitly importing and calling <code>ReactDOM.render()</code> on your component is a more common approach than the custom standalone interface approach (i.e., <code>renderReactPlayer()</code>) used in Figure <a href="client-side.html#fig:react-player">22.2</a>.</p>
<p></p>
<details>
<p><summary>Click to see code</summary></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="client-side.html#cb210-1"></a>data_grid_js &lt;-<span class="st"> </span>runpkg<span class="op">::</span><span class="kw">download_files</span>(</span>
<span id="cb210-2"><a href="client-side.html#cb210-2"></a>  <span class="st">&quot;react-data-grid&quot;</span>, </span>
<span id="cb210-3"><a href="client-side.html#cb210-3"></a>  <span class="st">&quot;dist/react-data-grid.min.js&quot;</span></span>
<span id="cb210-4"><a href="client-side.html#cb210-4"></a>)</span>
<span id="cb210-5"><a href="client-side.html#cb210-5"></a></span>
<span id="cb210-6"><a href="client-side.html#cb210-6"></a><span class="co"># the data table placeholder</span></span>
<span id="cb210-7"><a href="client-side.html#cb210-7"></a>data_grid &lt;-<span class="st"> </span>tags<span class="op">$</span><span class="kw">div</span>(<span class="dt">id =</span> <span class="st">&quot;data-grid&quot;</span>)</span>
<span id="cb210-8"><a href="client-side.html#cb210-8"></a></span>
<span id="cb210-9"><a href="client-side.html#cb210-9"></a><span class="co"># upon clicking the marker, populate a video </span></span>
<span id="cb210-10"><a href="client-side.html#cb210-10"></a><span class="co"># in the DOM element with an id of &#39;video&#39;</span></span>
<span id="cb210-11"><a href="client-side.html#cb210-11"></a>p &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(mtcars, <span class="dt">x =</span> <span class="op">~</span>wt, <span class="dt">y =</span> <span class="op">~</span>mpg) <span class="op">%&gt;%</span></span>
<span id="cb210-12"><a href="client-side.html#cb210-12"></a><span class="st">  </span><span class="kw">add_markers</span>(<span class="dt">customdata =</span> <span class="kw">row.names</span>(mtcars)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb210-13"><a href="client-side.html#cb210-13"></a><span class="st">  </span><span class="kw">layout</span>(<span class="dt">dragmode =</span> <span class="st">&quot;select&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb210-14"><a href="client-side.html#cb210-14"></a><span class="st">  </span><span class="kw">onRender</span>(<span class="kw">babel_transform</span>(   </span>
<span id="cb210-15"><a href="client-side.html#cb210-15"></a>    <span class="st">&quot;el =&gt; {</span></span>
<span id="cb210-16"><a href="client-side.html#cb210-16"></a><span class="st">       var container = document.getElementById(&#39;data-grid&#39;);</span></span>
<span id="cb210-17"><a href="client-side.html#cb210-17"></a><span class="st">       var columns = [</span></span>
<span id="cb210-18"><a href="client-side.html#cb210-18"></a><span class="st">         {key: &#39;x&#39;, name: &#39;Weight&#39;}, </span></span>
<span id="cb210-19"><a href="client-side.html#cb210-19"></a><span class="st">         {key: &#39;y&#39;, name: &#39;MPG&#39;}, </span></span>
<span id="cb210-20"><a href="client-side.html#cb210-20"></a><span class="st">         {key: &#39;customdata&#39;, name: &#39;Model&#39;}</span></span>
<span id="cb210-21"><a href="client-side.html#cb210-21"></a><span class="st">        ];</span></span>
<span id="cb210-22"><a href="client-side.html#cb210-22"></a><span class="st">       el.on(&#39;plotly_selecting&#39;, d =&gt; {</span></span>
<span id="cb210-23"><a href="client-side.html#cb210-23"></a><span class="st">          if (d.points) {</span></span>
<span id="cb210-24"><a href="client-side.html#cb210-24"></a><span class="st">            var grid = &lt;ReactDataGrid </span></span>
<span id="cb210-25"><a href="client-side.html#cb210-25"></a><span class="st">              columns={columns} </span></span>
<span id="cb210-26"><a href="client-side.html#cb210-26"></a><span class="st">              rowGetter={i =&gt; d.points[i]} </span></span>
<span id="cb210-27"><a href="client-side.html#cb210-27"></a><span class="st">              rowsCount={d.points.length} </span></span>
<span id="cb210-28"><a href="client-side.html#cb210-28"></a><span class="st">            /&gt;;</span></span>
<span id="cb210-29"><a href="client-side.html#cb210-29"></a><span class="st">            ReactDOM.render(grid, container);</span></span>
<span id="cb210-30"><a href="client-side.html#cb210-30"></a><span class="st">          }</span></span>
<span id="cb210-31"><a href="client-side.html#cb210-31"></a><span class="st">        });</span></span>
<span id="cb210-32"><a href="client-side.html#cb210-32"></a><span class="st">        el.on(&#39;plotly_deselect&#39;, d =&gt; { </span></span>
<span id="cb210-33"><a href="client-side.html#cb210-33"></a><span class="st">          ReactDOM.render(null, container); </span></span>
<span id="cb210-34"><a href="client-side.html#cb210-34"></a><span class="st">        });</span></span>
<span id="cb210-35"><a href="client-side.html#cb210-35"></a><span class="st">     }&quot;</span></span>
<span id="cb210-36"><a href="client-side.html#cb210-36"></a>  ))</span>
<span id="cb210-37"><a href="client-side.html#cb210-37"></a></span>
<span id="cb210-38"><a href="client-side.html#cb210-38"></a><span class="co"># create the HTML page</span></span>
<span id="cb210-39"><a href="client-side.html#cb210-39"></a><span class="kw">browsable</span>(</span>
<span id="cb210-40"><a href="client-side.html#cb210-40"></a>  <span class="kw">tagList</span>(p, data_grid, <span class="kw">html_dependency_react</span>(), data_grid_js)</span>
<span id="cb210-41"><a href="client-side.html#cb210-41"></a>)</span></code></pre></div>
</details>
<div class="figure" style="text-align: center"><span id="fig:react-data-grid"></span>
<iframe src="https://player.vimeo.com/video/325933744?title=0&amp;byline=0&amp;portrait=0" width="100%" height="400" frameborder="0" seamless="seamless" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<p class="caption">
FIGURE 22.4: Using the <code>react-data-grid</code> React component to render a data table of the observation within a scatterplot brush. For the interactive, see <a href="https://plotly-r.com/interactives/react-data-grid.html" class="uri">https://plotly-r.com/interactives/react-data-grid.html</a>
</p>
</div>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-d3js">
<p>Heer, Michael Bostock AND Vadim Ogievetsky AND Jeffrey. 2011. “D3: Data-Driven Documents.” <em>IEEE Trans. Visualization &amp; Comp. Graphics (Proc. InfoVis)</em>. <a href="http://vis.stanford.edu/papers/d3">http://vis.stanford.edu/papers/d3</a>.</p>
</div>
<div id="ref-reactR">
<p>Inc, Facebook, Kent Russell, and Alan Dipert. 2019. <em>ReactR: React Helpers</em>. <a href="https://CRAN.R-project.org/package=reactR">https://CRAN.R-project.org/package=reactR</a>.</p>
</div>
<div id="ref-runpkg">
<p>Sievert, Carson. 2019b. <em>Runpkg: Tools for Working with ’Unpkg’</em>. <a href="https://github.com/cpsievert/runpkg">https://github.com/cpsievert/runpkg</a>.</p>
</div>
<div id="ref-servr">
<p>Xie, Yihui. 2016. <em>Servr: A Simple Http Server to Serve Static Files or Dynamic Documents</em>. <a href="https://CRAN.R-project.org/package=servr">https://CRAN.R-project.org/package=servr</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="40">
<li id="fn40"><p>React is a modern JavaScript library, backed by Facebook, for building and distributing components of a website – <a href="https://reactjs.org/" class="uri">https://reactjs.org/</a><a href="client-side.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p>There are thousands of React components available. To get a sense what’s available, see this list <a href="https://github.com/brillout/awesome-react-components" class="uri">https://github.com/brillout/awesome-react-components</a>. <a href="client-side.html#fnref41" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script>
  var header = document.querySelector(".book-header");

  var img = document.createElement("img");
  img.src = "images/rstudioCloud.svg";
  img.width = 200;
  img.align = "right";
  img.style = "margin-top:10px; float:right";

  var a = document.createElement("a");
  a.href = "https://rstudio.cloud/project/156701";
  a.target = "_blank";

  a.appendChild(img);
  header.appendChild(a);
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-60116966-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-60116966-3');
</script>
<script>
window.onload = function() {

  var imgs = document.querySelectorAll('img');

  // Upon clicking an image, open a new window with the
  // dimensions of the image, pointing the `data-url` link
  var on_click = function (e) {
    var d = e.target.dataset || {};
    if (d.url) {
      // Add some extra height for the modebar
      var height = 'height=' + (e.target.clientHeight * 1.05);
      var width = 'width=' + e.target.clientWidth;
      var param = 'location=yes,' + height + ',' + width + ',scrollbars=yes,status=yes';
      window.open(e.target.dataset.url, '_blank', param);
    }
  };

  var on_hover = function (e) {
    var d = e.target.dataset || {};
    if (d.url) {
      e.target.style.cursor = 'pointer';
    }
  };

  for (var i = 0; i < imgs.length; i++) {
    imgs[i].addEventListener('click', on_click);
    imgs[i].addEventListener('mouseover', on_hover);
  }
};
</script>
            </section>

          </div>
        </div>
      </div>
<a href="supplying-custom-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="is-plotly-free-secure.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cpsievert/plotly_book/edit/master/javascript.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
